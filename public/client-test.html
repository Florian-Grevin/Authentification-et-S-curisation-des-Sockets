<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Test Socket.IO</title>
<script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
<style>
body { font-family: sans-serif; padding: 20px; }
.log { background: #f4f4f4; border: 1px solid #ddd; padding: 10px; height: 300px; overflow-y: scroll; }
</style>
</head>
<body>

<h1>Console Client Socket.IO</h1>

<button onclick="sendPing()">Envoyer PING</button>
<button onclick="sendChat()">üí¨ Parler dans General</button>

<div id="logs" class="log"></div>

<script>
const socket = io('http://localhost:3000', {
    withCredentials: true
});

const logDiv = document.getElementById('logs');

// ‚úÖ Fonction manquante ‚Äî la voici !
function addLog(message) {
    const p = document.createElement('p');
    p.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
    logDiv.appendChild(p);
}

socket.on('connect', () => {
    addLog(`Connect√© au serveur avec l'ID : ${socket.id}`);
});

socket.on("connect_error", (err) => {
    addLog("User not connected : " + err.message);
});

// Chat g√©n√©ral
socket.on('new_message', (data) => {
    addLog(`[${data.from}] : ${data.content}`);
});

// Notifications priv√©es
socket.on('notification', (data) => {
    addLog(`[PRIV√â] ${data.from} : ${data.text}`);
    alert(`Notification re√ßue : ${data.text}`);
});


// Ping
function sendPing() {
    addLog('Envoi de "ping"...');
    socket.emit('my_ping', { text: 'Hello Server!' });
}

// Chat g√©n√©ral
function sendChat() {
    const text = prompt("Votre message pour le groupe General :");
    if (text) {
        socket.emit('chat_message', { content: text });
    }
}
</script>

</body>
</html>
